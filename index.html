<!DOCTYPE html>
<html>
<head>
  <title>AA PIT Tracker — Phase 7.0</title>
<style>
:root {
  --bg: #000000;
  --text: #ffffff;
  --mainline-light: #00ffff;
  --mainline-dark: #007aff;
  --regional-light: #ff4444;
  --regional-dark: #aa0000;
}

html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: hidden;
}

body {
  display: flex;
  flex-direction: column;
  background: var(--bg);
  color: var(--text);
  font-family: 'Courier New', Courier, monospace;
  font-size: 1.6rem;
  letter-spacing: 0.06em;
}

input, button {
  padding: 16px;
  font-size: 1.6rem;
  border-radius: 10px;
  border: 2px solid cyan;
  background: black;
  color: cyan;
  text-shadow: 0 0 4px cyan;
  transition: all 0.3s ease;
}

input:focus, button:focus {
  outline: none;
  background: #111;
  box-shadow: 0 0 12px cyan;
}

button {
  cursor: pointer;
  background: linear-gradient(to right, #00ffff, #007aff);
  color: black;
  font-weight: bold;
  text-shadow: none;
}

button:active {
  transform: scale(0.95);
}

#theme-toggle {
  display: none;
}

.board {
  flex-grow: 1;
  display: grid;
  grid-template-columns: 1.1fr 1.2fr 0.7fr;
  gap: 12px;
  padding: 10px;
  overflow: hidden;
}

.column {
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  background: #111;
  border: 2px solid #00ffff;
  border-radius: 12px;
  box-shadow: 0 0 30px rgba(0,255,255,0.2);
  padding: 10px;
}

.section-group {
  display: flex;
  flex-direction: column;
  margin-bottom: 28px;
}

.section-group:last-of-type {
  margin-bottom: 0;
}

.section-group .card-container {
  flex-shrink: 0;
}

.column h2,
.sub-section h3 {
  font-size: 2rem;
  color: #00ffff;
  text-shadow: 0 0 6px #00ffff;
  background: #000;
  padding: 8px;
  position: sticky;
  top: -12px;
  z-index: 2;
}

.column[data-status="Needs Service"] .sub-section h3 {
  top: 3.5rem;
}

.count {
  font-size: 2rem;
  font-weight: bold;
  color: #ff00ff;
  text-shadow: 0 0 6px #ff00ff;
}

.card-container,
.sub-section {
  min-height: 60px;
  padding: 5px;
  border: 2px dashed transparent;
  transition: background 0.2s ease;
}

.card-container.dragover,
.sub-section.dragover {
  border-color: #ff00ff;
  background: rgba(255, 0, 255, 0.1);
}

.sub-section {
  margin-top: 10px;
}

.card {
  background: #111;
  border-left: 10px solid transparent;
  border-radius: 10px;
  padding: 14px;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 10px;
  font-weight: bold;
  font-size: 2.2rem;
  color: lime;
  text-shadow: 0 0 4px lime;
  box-shadow: 0 0 12px rgba(0,255,0,0.4);
  transition: all 0.2s ease;
}

.card.in-the-air {
  background: #220022;
  color: magenta;
  text-shadow: 0 0 6px magenta;
}

.card.not-serviced-card {
  background: #221100;
  color: orange;
  text-shadow: 0 0 6px orange;
}

.card:active {
  transform: scale(0.88);
}

.mainline {
  border-left-color: cyan;
  background: #001122;
}

.regional {
  border-left-color: red;
  background: #220000;
}

.flight-number {
  flex: 1;
  text-align: left;
  font-size: 2.4rem;
}

.tail-input,
.gate-input {
  background: transparent;
  color: yellow;
  font-size: 2.4rem;
  text-align: center;
  border: none;
  width: 6ch;
  font-weight: bold;
}

.tail-input:focus,
.gate-input:focus {
  background: black;
  border: 2px solid yellow;
  box-shadow: 0 0 10px yellow;
  outline: none;
}

.eta-timer {
  font-size: 2.4rem;
  font-weight: bold;
  margin-left: auto;
  color: #ffcc00;
  text-shadow: 0 0 8px #ffcc00;
  cursor: pointer;
}

.drag-handle {
  width: 16px;
  background: repeating-linear-gradient(
    90deg,
    #fff,
    #fff 2px,
    transparent 2px,
    transparent 4px
  );
  margin-left: auto;
  height: 100%;
  cursor: grab;
}

.trash-zone {
  font-size: 1.8rem;
  border: 3px dashed red;
  background: rgba(255, 0, 0, 0.1);
  color: red;
  padding: 12px;
  text-align: center;
  border-radius: 10px;
  transition: background 0.3s ease;
}

.trash-zone.dragover {
  background: rgba(255, 0, 0, 0.3);
}

.footer-controls {
  background: #000;
  padding: 10px;
  display: flex;
  justify-content: center;
  gap: 20px;
  border-top: 2px solid cyan;
}

.footer-controls button {
  font-size: 1.6rem;
  padding: 14px 24px;
  border: 2px solid #00ffff;
  background: black;
  color: #00ffff;
  text-shadow: 0 0 6px #00ffff;
}

.live-clock {
  position: fixed;
  top: 10px;
  right: 10px;
  background: black;
  color: #00ffff;
  border: 2px solid #00ffff;
  font-size: 2.8rem;
  font-weight: bold;
  padding: 12px 24px;
  border-radius: 999px;
  z-index: 9999;
  text-align: center;
  font-family: monospace;
  box-shadow: 0 0 16px cyan;
  cursor: pointer;
}

.weather-modal {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 85vw;
  height: 85vh;
  background: black;
  border: 3px solid cyan;
  z-index: 10000;
  border-radius: 12px;
  overflow: hidden;
  display: none;
}

.weather-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 255, 255, 0.15);
  z-index: 9999;
  display: none;
}

#logo {
  position: absolute;
  top: 10px;
  left: 10px;
  height: 60px;
  object-fit: contain;
  z-index: 1001;
  filter: drop-shadow(0 0 8px white);
}
</style>
</head>
<body class="dark">
  <button id="theme-toggle"></button>
<img src="https://raw.githubusercontent.com/dsstaub/LavTracker/main/Image%2071.jpeg" alt="Logo" id="logo">
  <div id="flight-form">
    <input id="flight-number" placeholder="Flight #" style="background-color: transparent; color: white; border: 1px solid #2c2c2c; outline: none;">
    <input id="tail-number" placeholder="Tail #" style="background-color: transparent; color: white; border: 1px solid #2c2c2c; outline: none;">
    <button id="add-btn">Add Flight</button>
  </div>

  <div class="board">
<div class="column" data-status="Arrived">
  <div class="section-group">
    <h2>On The Ground <span class="count" id="count-OnGround"></span></h2>
    <div class="card-container" id="OnGround"></div>
  </div>

  <div class="section-group">
    <h2>In The Air <span class="count" id="count-UpNext"></span></h2>
    <div class="card-container" id="UpNext"></div>
  </div>

  <div class="section-group">
    <h2>Scheduled <span class="count" id="count-Scheduled"></span></h2>
    <div class="card-container" id="Scheduled"></div>
  </div>
</div>
    
    <div class="column" data-status="Serviced">
      <h2>Fully Serviced <span class="count" id="count-Serviced"></span></h2>
      <div class="card-container" id="Serviced"></div>
    </div>

    <div class="column" data-status="Needs Service">
      <h2>Not Serviced <span class="count" id="count-NeedsService"></span></h2>
      <div id="Needs Service">
        <div class="sub-section" id="Needs Water"><h3>Needs Water Filled<span class="count" id="count-NeedsWater"></span></h3></div>
        <div class="sub-section" id="Needs Lav"><h3>Needs Lav Dumped<span class="count" id="count-NeedsLav"></span></h3></div>
        <div class="sub-section" id="Needs Both"><h3>Needs Full Service <span class="count" id="count-NeedsBoth"></span></h3></div>
      </div>
    </div>
  </div>

  <div class="trash-zone" id="trash">Drag Here to Delete</div>

  <div class="footer-controls">
    <button onclick="downloadReport()">Export Report</button>
    <button onclick="clearAll()">Clear All Flights</button>
  </div>

  <div class="live-clock" id="live-clock">--ºF --:--:--</div>
  <div class="weather-overlay" id="weather-overlay" style="display: none;"></div>
<div class="weather-modal" id="weather-modal">
<div style="
  width: 100%;
  height: 100%;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  background: black;
">
  <img
  src="https://wttr.in/KPIT.png?u"
  alt="KPIT Weather"
  style="max-width: 100%; max-height: 100%; object-fit: contain; transform: scale(1.2) translateX(110px); transform-origin: center center;"
/>
  </div>
</div>
  <script>
window.onload = () => {
  const flightInput = document.getElementById('flight-number');
  const tailInput = document.getElementById('tail-number');
  const themeToggle = document.getElementById('theme-toggle');
  const body = document.body;
  let cards = [];

  if (localStorage.getItem('theme') === 'dark') body.classList.add('dark');
  themeToggle.onclick = () => {
    body.classList.toggle('dark');
    localStorage.setItem('theme', body.classList.contains('dark') ? 'dark' : 'light');
  };

  try {
    const stored = JSON.parse(localStorage.getItem('flightCards'));
    if (Array.isArray(stored)) cards = stored;
  } catch {}

  document.getElementById('add-btn').onclick = () => {
    const flight = flightInput.value.trim().toUpperCase();
    const tail = tailInput.value.trim().toUpperCase();
    if (!flight) return;
    if (cards.some(c => c.flight === flight)) return alert("Flight exists.");
    const dup = cards.find(c => c.tail === tail && tail !== "");
    if (dup && !confirm("Replace existing tail?")) return;
    if (dup) cards = cards.filter(c => c.id !== dup.id);
    const newCard = { id: Date.now().toString(), flight, tail, gate: '', status: 'Scheduled', serviceType: null, eta: null };
    cards.push(newCard);
    saveCards();
    renderCards(newCard.id);
    flightInput.value = '';
    tailInput.value = '';
  };

  function saveCards() {
    localStorage.setItem('flightCards', JSON.stringify(cards));
  }

  function getFlightClass(flight) {
    const num = parseInt(flight.replace(/[^\d]/g, ''));
    return (num >= 1 && num <= 2949) || (num >= 6300 && num <= 6349) ? 'mainline' : 'regional';
  }

  function formatCountdown(ms) {
    const neg = ms < 0;
    ms = Math.abs(ms);
    const h = Math.floor(ms / 3600000);
    const m = Math.floor((ms % 3600000) / 60000);
    return (neg ? '-' : '') + `${h}:${m.toString().padStart(2, '0')}`;
  }

  function parseETAInput(input) {
    input = input.replace(/\s+/g, '');
    if (/^\d{4}$/.test(input)) {
      return [input.slice(0, 2), input.slice(2)];
    } else if (/^\d{1,2}:\d{2}$/.test(input)) {
      return input.split(':');
    }
    return null;
  }

function renderCards(highlightId = null) {
  const zones = ['OnGround', 'Scheduled', 'UpNext', 'Serviced'];
  const subs = ['Needs Water', 'Needs Lav', 'Needs Both'];
  zones.forEach(z => document.getElementById(z).innerHTML = '');
  subs.forEach(s => {
    document.getElementById(s).innerHTML = `<h3>${s} <span class="count" id="count-${s.replace(" ", "")}"></span></h3>`;
  });

  document.addEventListener('keydown', (e) => {
    if (e.key === ' ' && document.activeElement.tagName !== 'INPUT') {
      e.preventDefault();
      document.getElementById('flight-number').focus();
    }
  });

  let needsServiceTotal = 0;

  cards.sort((a, b) => {
    if (a.status === 'Arrived' && b.status === 'Arrived') {
      return new Date(a.eta || 0) - new Date(b.eta || 0);
    }
    if (a.status === 'Serviced' && b.status === 'Serviced') {
      return (a.servicedAt || '').localeCompare(b.servicedAt || '');
    }
    return 0;
  });

  document.addEventListener('click', (e) => {
  const isInput = e.target.tagName === 'INPUT' || e.target.closest('input');
  if (!isInput) {
    const active = document.activeElement;
    if (active && active.tagName === 'INPUT') {
      active.blur();
    }
  }
});

  cards.forEach(card => {
    const div = document.createElement('div');
    let cardClass = `card ${getFlightClass(card.flight)}`;
if (card.status === 'Arrived' && card.eta) cardClass += ' in-the-air';
if (card.status === 'Needs Service') cardClass += ' not-serviced-card';
div.className = cardClass;
    div.dataset.id = card.id;
    div.draggable = true;
    if (card.id === highlightId) div.classList.add('highlighted');

const flightSpan = document.createElement('span');
flightSpan.className = 'flight-number';
flightSpan.innerHTML = `<span style="font-size:0.01rem; opacity:0.01">AA</span>${card.flight.replace(/[^\d]/g, '')}`;

    
    const tailField = document.createElement('input');
    tailField.className = 'tail-input';
    tailField.value = card.tail;
    tailField.maxLength = 4;
    tailField.placeholder = 'TAIL';
    tailField.onchange = () => updateTail(card.id, tailField.value);
    tailField.onclick = () => tailField.select();

    const gateField = document.createElement('input');
    gateField.className = 'gate-input';
    gateField.value = card.gate || '';
    gateField.maxLength = 4;
    gateField.placeholder = 'GATE';
    gateField.onchange = () => updateGate(card.id, gateField.value);
    gateField.onclick = () => gateField.select();

    const handle = document.createElement('div');
    handle.className = 'drag-handle';

    const timer = document.createElement('div');
    timer.className = 'eta-timer';
    timer.style.marginLeft = 'auto';
    timer.style.fontWeight = 'bold';
    timer.style.cursor = 'pointer';
    timer.style.fontSize = '1.8rem';

    if (card.status === 'Arrived') {
      const update = () => {
        if (!card.eta) return;
        const diff = new Date(card.eta) - new Date();
        timer.textContent = formatCountdown(diff);
        timer.style.animation = Math.abs(diff) < 180000 ? 'flash-orange 1s infinite alternate' : '';
      };

      timer.onclick = () => {
        const current = card.eta ? new Date(card.eta) : null;
        const placeholder = current ? current.getHours().toString().padStart(2, '0') + ':' + current.getMinutes().toString().padStart(2, '0') : '';
        const newEtaInput = prompt("Update ETA (HHMM or HH:MM):", placeholder);
        const parts = parseETAInput(newEtaInput || '');
        if (parts) {
          const [h, m] = parts.map(Number);
          const now = new Date();
          const etaDate = new Date(now.getFullYear(), now.getMonth(), now.getDate(), h, m);
          if (etaDate < now) etaDate.setDate(etaDate.getDate() + 1);
          card.eta = etaDate.toISOString();
          saveCards();
          renderCards();
        } else {
          alert("Invalid format. Use HHMM or HH:MM");
        }
      };

      update();
      setInterval(update, 60000);
    }

    handle.addEventListener('touchstart', (e) => {
      e.stopPropagation();
      div.dispatchEvent(new DragEvent("dragstart", { dataTransfer: new DataTransfer() }));
    });

    handle.addEventListener('mousedown', (e) => {
      e.stopPropagation();
      div.dispatchEvent(new DragEvent("dragstart", { dataTransfer: new DataTransfer() }));
    });

    div.appendChild(flightSpan);
    div.appendChild(tailField);
    if (card.status === 'Serviced' && card.servicedAt) {
      const timestamp = document.createElement('span');
      timestamp.textContent = card.servicedAt;
      timestamp.style.fontSize = '2.2rem';
      timestamp.style.color = 'turquoise';
      timestamp.style.margin = '0 4px';
      div.appendChild(timestamp);
    }
    div.appendChild(gateField);
    if (card.status === 'Arrived') div.appendChild(timer);
    div.appendChild(handle);

    div.addEventListener('dragstart', e => {
      div.classList.add('dragging');
      e.dataTransfer.setData('text/plain', card.id);
    });

    div.addEventListener('dragend', () => div.classList.remove('dragging'));

    let sectionId = card.status;
    if (sectionId === 'Arrived' && card.eta) {
      sectionId = 'UpNext';
    } else if (sectionId === 'Arrived' && !card.eta) {
      sectionId = 'OnGround';
    }

    const section = card.status === 'Needs Service'
      ? document.getElementById(card.serviceType || 'Needs Water')
      : document.getElementById(sectionId);

    if (section) {
      section.appendChild(div);
      if (card.status === 'Needs Service') needsServiceTotal++;
    }

    if (card.id === highlightId) {
      setTimeout(() => div.classList.remove('highlighted'), 1000);
    }
  });

  document.getElementById('count-NeedsService').innerText = needsServiceTotal;
  document.getElementById('count-NeedsWater').innerText = document.getElementById('Needs Water').querySelectorAll('.card').length;
  document.getElementById('count-NeedsLav').innerText = document.getElementById('Needs Lav').querySelectorAll('.card').length;
  document.getElementById('count-NeedsBoth').innerText = document.getElementById('Needs Both').querySelectorAll('.card').length;
  ['OnGround', 'Scheduled', 'UpNext', 'Serviced'].forEach(z => {
    const count = document.getElementById(z).querySelectorAll('.card').length;
    document.getElementById('count-' + z).innerText = count;
  });

  bindDropZones();
}

  window.updateTail = (id, value) => {
    const c = cards.find(c => c.id === id);
    if (!c) return;
    const newTail = value.trim().toUpperCase();
    const dup = cards.find(x => x.tail === newTail && x.id !== id);
    if (dup && !confirm("Replace existing tail?")) return renderCards();
    cards = cards.filter(x => x.id !== (dup?.id || ""));
    c.tail = newTail;
    saveCards(); renderCards();
  };

  window.updateGate = (id, value) => {
    const c = cards.find(c => c.id === id);
    if (c) {
      c.gate = value.trim().toUpperCase();
      saveCards();
    }
  };

  function bindDropZones() {
    const allZones = [...document.querySelectorAll('.card-container, .sub-section')];
    allZones.forEach(container => {
      container.ondragover = (e) => {
        e.preventDefault();
        container.classList.add('dragover');
        const dragging = document.querySelector('.dragging');
        const after = getDragAfterElement(container, e.clientY);
        if (!after) container.appendChild(dragging);
        else container.insertBefore(dragging, after);
      };
      container.ondragleave = () => container.classList.remove('dragover');
      container.ondrop = (e) => {
        e.preventDefault();
        container.classList.remove('dragover');
        const id = e.dataTransfer.getData('text/plain');
        const card = cards.find(c => c.id === id);
        if (!card) return;
        const column = container.closest('.column')?.getAttribute('data-status');
        const isSub = container.classList.contains('sub-section');
        const targetId = container.id;
let newStatus = column;
if (column === 'Arrived') {
  if (targetId === 'UpNext') {
    newStatus = 'Arrived';
  } else if (targetId === 'OnGround') {
    newStatus = 'Arrived';
    card.eta = null; // Clear ETA
  } else if (targetId === 'Scheduled') {
    newStatus = 'Scheduled';
  }
}        if (targetId === 'UpNext' && card.status !== 'Arrived') {
  const etaInput = prompt("Enter ETA (HHMM or HH:MM):");
  const parts = parseETAInput(etaInput || '');
  if (parts) {
    const [h, m] = parts.map(Number);
    const now = new Date();
    const etaDate = new Date(now.getFullYear(), now.getMonth(), now.getDate(), h, m);
    if (etaDate < now) etaDate.setDate(etaDate.getDate() + 1);
    card.eta = etaDate.toISOString();
  } else {
    alert("Invalid format. Use HHMM or HH:MM");
  }
}

        card.status = newStatus;
        card.serviceType = isSub ? targetId : null;

        if (newStatus === 'Serviced') {
          const now = new Date();
          card.servicedAt = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
        } else {
          delete card.servicedAt;
        }

        const reorderedIds = Array.from(container.querySelectorAll('.card')).map(c => c.dataset.id);
        const reordered = reorderedIds.map(id => cards.find(c => c.id === id));
        const otherCards = cards.filter(c => !reorderedIds.includes(c.id));
        cards = [...otherCards, ...reordered];
        saveCards(); renderCards();
      };
    });

    const trash = document.getElementById('trash');
    trash.ondragover = (e) => {
      e.preventDefault();
      trash.classList.add('dragover');
    };
    trash.ondragleave = () => trash.classList.remove('dragover');
    trash.ondrop = (e) => {
      e.preventDefault();
      trash.classList.remove('dragover');
      const id = e.dataTransfer.getData('text/plain');
      const card = cards.find(c => c.id === id);
      if (!card) return;
      if (confirm(`Delete flight ${card.flight}?`)) {
        cards = cards.filter(c => c.id !== id);
        saveCards();
        renderCards();
      }
    };
  }

  function getDragAfterElement(container, y) {
    const cards = [...container.querySelectorAll('.card:not(.dragging)')];
    return cards.reduce((closest, child) => {
      const box = child.getBoundingClientRect();
      const offset = y - box.top - box.height / 2;
      return (offset < 0 && offset > closest.offset) ? { offset, element: child } : closest;
    }, { offset: Number.NEGATIVE_INFINITY }).element;
  }

  window.clearAll = () => {
    if (confirm("Clear all saved flights?")) {
      localStorage.removeItem('flightCards');
      cards = [];
      renderCards();
    }
  };

  ['flight-number', 'tail-number'].forEach(id => {
    document.getElementById(id).addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        e.preventDefault();
        document.getElementById('add-btn').click();
      }
    });
  });

  document.addEventListener('keydown', (e) => {
    const isCardField = e.target.classList.contains('tail-input') || e.target.classList.contains('gate-input');
    if (e.key === 'Enter' && isCardField) {
      e.preventDefault();
      e.target.blur();
    }
  });

  renderCards();
};

// Export Report Functions
function generateReport() {
  const now = new Date();
  const yyyy = now.getFullYear();
  const mm = String(now.getMonth() + 1).padStart(2, '0');
  const dd = String(now.getDate()).padStart(2, '0');
  const title = `Lav Report - ${yyyy}${mm}${dd}`;

  let report = `Station: PIT - PM/RON\nEmployee #: 933998\n${title}\n\n`;

  const sections = [
    { id: 'Serviced', label: 'Fully Serviced' },
    { id: 'Needs Water', label: 'Needs Water Filled', parent: 'Not Serviced' },
    { id: 'Needs Lav', label: 'Needs Lav Dumped', parent: 'Not Serviced' },
    { id: 'Needs Both', label: 'Needs Full Service', parent: 'Not Serviced' }
  ];

  sections.forEach(section => {
    if (section.parent) {
      report += `\n${section.parent}\n  ${section.label}\n`;
    } else {
      report += `\n${section.label}\n`;
    }

    const cards = document.getElementById(section.id)?.querySelectorAll('.card') || [];

    cards.forEach(card => {
      const flight = card.querySelector('.flight-number')?.textContent || '';
      const tail = card.querySelector('.tail-input')?.value || '';
      const gate = card.querySelector('.gate-input')?.value || '';
      const timestampEl = Array.from(card.querySelectorAll('span')).find(el => el.textContent.includes(':'));
      const timestamp = timestampEl ? timestampEl.textContent.trim() : '';

      if (section.id === 'Serviced') {
        report += `    ${flight}_${tail}_${timestamp}_${gate}\n`;
      } else {
        report += `    ${flight}_${tail}_${gate}\n`;
      }
    });
  });

  return { title, text: report };
}

function downloadReport() {
  const { title, text } = generateReport();
  const blob = new Blob([text], { type: 'text/plain' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = `${title}.txt`;
  a.click();
}

let currentTemp = '...';

async function fetchTemperature() {
  try {
    const res = await fetch('https://wttr.in/KPIT?format=%t&u');
    const text = await res.text();
    currentTemp = text.trim();
  } catch (err) {
    currentTemp = '??ºF';
  }
}

// Update time + temp display
function updateClock() {
  const now = new Date();
  const h = now.getHours().toString().padStart(2, '0');
  const m = now.getMinutes().toString().padStart(2, '0');
  const s = now.getSeconds().toString().padStart(2, '0');

  const tempStyle = currentTemp === '??ºF'
    ? `style="color: ${now.getSeconds() % 2 === 0 ? 'red' : 'white'}"`
    : '';

  const clockHTML = `
    <span ${tempStyle}>${currentTemp}</span>
    ${h}:${m}:${s}
  `;

  document.getElementById('live-clock').innerHTML = clockHTML;
}
  
  // Set up intervals
setInterval(updateClock, 1000);       // Update clock every second
setInterval(fetchTemperature, 300000); // Refresh temp every 5 min
fetchTemperature();                   // Initial fetch
updateClock();                        // Initial clock render


document.addEventListener("DOMContentLoaded", () => {
  const clock = document.getElementById("live-clock");
  const modal = document.getElementById("weather-modal");
  const overlay = document.getElementById("weather-overlay");

  clock.addEventListener("click", () => {
    modal.style.display = "block";
    overlay.style.display = "block";
  });

  overlay.addEventListener("click", () => {
    modal.style.display = "none";
    overlay.style.display = "none";
  });
});
</script>
</body>
</html>
